a:
  build: a
  environment:
    VIRTUAL_HOST: a.localhost
  restart: always

b:
  build: b
  environment:
    VIRTUAL_HOST:  b.localhost
  restart: always
c:
  build: c
  environment:
    VIRTUAL_HOST: localhost
  restart: always  

nginx-proxy:
  image: jwilder/nginx-proxy
  ports:
    - "80:80"
    - "443:443"
  volumes:
    - /var/run/docker.sock:/tmp/docker.sock:ro

  restart: always
  privileged: true
